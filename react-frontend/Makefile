all: help

help:     ## Show this help.
	@echo 'Usage: make [TARGET]'
	@echo 'Targets:'
	@grep '^[a-zA-Z]' $(MAKEFILE_LIST) | awk -F ':.*?## ' 'NF==2 {printf "\033[36m  %-25s\033[0m %s\n", $$1, $$2}'

init:	  		## One time NPN initialisation (for node_modules)
	export END_POINT=`kubectl get services go-web-service -o json |jq -r .status.loadBalancer.ingress[0].hostname`
	echo 'END POINT for k8s Go service is: ${END_POINT}'
	echo "/* This File was automatically generated by make (see Makefile!) */\nexport const getEndPoint = () => {\n  return ${END_POINT}\n}" > src/utils/config.js
	npm install

npm:			## NPM creates and links the build folder for distribution on a static website
	npm run build	
	cp build/index.html build/about.html
	cp build/index.html build/signup.html
	cp build/index.html build/admin.html

s3:				## Transfer files to a static web serving s3 bucket
	aws s3 rm --recursive s3://virus-go
	aws s3 sync build s3://virus-go

update: npm s3		## Updates changes to the react front end in the s3 bucket
